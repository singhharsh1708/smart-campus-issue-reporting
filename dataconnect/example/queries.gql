mutation CreateCampusIssue(
    $locationId: UUID!,
    $reporterId: UUID!,
    $description: String!,
    $status: String!,
    $title: String!
) @auth(level: USER) {
  campusIssue_insert(
    data: {
      locationId: $locationId,
      reporterId: $reporterId,
      description: $description,
      status: $status,
      title: $title,
      createdAt_expr: "request.time"
    }
  )
}

query ListPublicCampusIssues @auth(level: PUBLIC, insecureReason: "This operation is safe to expose to the public") {
  campusIssues(where: {isPublic: {eq: true}}) {
    id
    title
    description
    location {
      name
      type
    }
  }
}

mutation AddCommentToCampusIssue(
    $issueId: UUID!,
    $content: String!,
    $isInternal: Boolean!
) @auth(level: USER) {
  comment_insert(
    data: {
      issueId: $issueId,
      content: $content,
      authorId_expr: "auth.uid",
      createdAt_expr: "request.time",
      isInternal: $isInternal
    }
  )
}

query GetMyCampusIssues @auth(level: USER, insecureReason: "This operation is safe to expose to all logged in users.") {
  campusIssues(where: {reporterId: {eq_expr: "auth.uid"}}) {
    id
    title
    description
    status
    location {
      name
      type
    }
  }
}